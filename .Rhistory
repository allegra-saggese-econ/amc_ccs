# read in the three datasets
getwd()
setwd("/csv_projects")
read.csv("/csv_projects/Microsoft_2021_CDR.csv")
# read in the three datasets
getwd()
setwd("~\")
setwd("~/")
setwd("~/")
# read in the three datasets
getwd()
# read in the three datasets
getwd()
read.csv("/csv_projects/Microsoft_2021_CDR.csv")
# read in the three datasets
setwd("C:\Users\SAGGESE\Documents\GitHub\amc_ccs\data\microsoft_2022_23\csv_projects")
setwd("C://Users//SAGGESE//Documents//GitHub//amc_ccs//data//microsoft_2022_23//csv_projects")
library(readr)
Microsoft_2021_CDR <- read_csv("Microsoft_2021_CDR.csv",
col_types = cols(`Newly contracted volume (mtCO2)` = col_number(),
`Contracted durability` = col_number()))
View(Microsoft_2021_CDR)
m21 <- read_csv("Microsoft_2021_CDR.csv",
col_types = cols(`Newly contracted volume (mtCO2)` = col_number(),
`Contracted durability` = col_number()))
m22 <- read_csv("Microsoft_2022_CDR.csv",
col_types = cols(`Newly contracted volume (mtCO2)` = col_number(),
`Contracted durability` = col_number()))
m23 <- read_csv("Microsoft_2023_CDR.csv",
col_types = cols(`Newly contracted volume (mtCO2)` = col_number(),
`Contracted durability` = col_number()))
View(m23)
View(m22)
View(m21)
View(Microsoft_2021_CDR)
library(tidyr)
library(dplyr)
library(ggplot2)
library(readr)
# read in the three datasets
m21 <- read_csv("Microsoft_2021_CDR.csv",
col_types = cols(`Newly contracted volume (mtCO2)` = col_number(),
`Contracted durability` = col_number()))
m22 <- read_csv("Microsoft_2022_CDR.csv",
col_types = cols(`Newly contracted volume (mtCO2)` = col_number(),
`Contracted durability` = col_number()))
m23 <- read_csv("Microsoft_2023_CDR.csv",
col_types = cols(`Newly contracted volume (mtCO2)` = col_number(),
`Contracted durability` = col_number()))
# drop empty row in m21
m21[!m21(data == "", 1, all),]
# drop empty row in m21
m21[!apply(m21 == "", 1, all),]
# drop empty row in m21
m21[!apply(is.na(m21)),]
m21[!apply(is.na(m21)),]
# drop empty row in m21
m21 <- m21[!apply(is.na(m21)),]
# drop empty row in m21
m21 %>% filter_all(any_vars(!is.na(.)))
# drop empty row in m21
m21 <- m21 %>% filter_all(any_vars(!is.na(.)))
library(readr)
Carbonplan_projects_20_21 <- read_csv("C:/Users/SAGGESE/Documents/GitHub/amc_ccs/data/Carbonplan_projects_20_21.csv")
View(Carbonplan_projects_20_21)
# upload the project CSV for comparison of the microsoft projects
carbonplan <- read_csv("C:/Users/SAGGESE/Documents/GitHub/amc_ccs/data/Carbonplan_projects_20_21.csv")
View(carbonplan)
mcarbonplan <- subset(carbonplan, source=="Microsoft 2021 CDR RFP")
View(mcarbonplan)
colnames(mcarbonplan)
# bind m21-23
cbind(m21,m22,m23)
# bind m21-23
rbind(m21,m22,m23)
colnames(m21)
colnames(m22)
colnames(m23)
m21 <- read_csv("Microsoft_2021_CDR.csv",
col_types = cols(`Newly contracted volume (mtCO2)` = col_number(),
`Contracted durability` = col_number()))
m21 <- m21 %>% filter_all(any_vars(!is.na(.))) %>%
rename("Contracted durability (years)" = "Contracted durability")
View(m21)
# bind m21-23
rbind(m21,m22,m23)
# bind m21-23
full_df <- rbind(m21,m22,m23)
View(full_df)
15+20+18
View(m21)
View(m22)
# bind m21-23
full_df <- rbind(m21,m22,m23) %>% filter_all(any_vars(!is.na(.)))
colnames(mcarbonplan)
# manual check of project by project in winning purchases
nat_con <- subset(mcarbonplan, applicant=="Nature Conservancy")
# manual check of project by project in winning purchases
nat_con <- subset(mcarbonplan, applicant=="The Nature Conservancy")
View(nat_con)
washington_component <- "MSFT150"
202369-2100000
2100000-202369
2100000-202369
clinch_valley_component <- c("MSFT101", "MSFT090", "MSFT086", "MSFT085")
+
View(m21)
View(m22)
View(m23)
View(full_df)
View(mcarbonplan)
library(pdftools)
library(tabulizer)
library(tabulizerjars)
library(tidyr)
library(lubridate)
library(kableExtra)
library(dplyr)
library(tidyverse)
# A: PURPOSE: Extract tables from Microsoft Annual reports on purchase agreements
# Set working directory
setwd("~/")
setwd("C:\\Users\\SAGGESE\\Documents\\GitHub\\amc_ccs\\data\\microsoft_2022_23")
mfiles <- list.files(pattern = "pdf$" )# create a vector of PDF file names
cdr_23 <- pdftools::pdf_text(pdf = mfiles[3])
write(cdr_23)
tablekey <- "Supplier"
table_unformat <- grep(tablekey, cdr_23, value=TRUE)
table_split <- unlist(strsplit(table_unformat, "\n\n\n"))
# drop the headers/footers from the string of characters in the PDF
dftest <- data.frame(table_split) %>%
filter(!row_number() %in% c(3)) %>%
filter(!row_number() %in% c(9)) %>%
filter(!row_number() %in% c(6)) %>%
filter(!row_number() %in% c(3))
dfmod <- dftest %>%
mutate(table_split = gsub("\\s{2,}", " ", table_split))
View(dfmod)
# A: PURPOSE: Extract relevant text from PDFs of project applications for Stripe / Frontier
setwd("C:\\Users\\SAGGESE\\Documents\\GitHub\\amc_ccs\\data\\applications_2022_23\\2022_fall")
getwd()
# A: PURPOSE: Extract relevant text from PDFs of project applications for Stripe / Frontier
setwd("C:\\Users\\SAGGESE\\Documents\\GitHub\\amc_ccs\\data\\stripe_data\\2020_total")
f20 <- list.files(pattern = "pdf$")
setwd("C:\\Users\\SAGGESE\\Documents\\GitHub\\amc_ccs\\data\\stripe_data\\2021_fall")
f21_1 <- list.files(pattern = "pdf$")
setwd("C:\\Users\\SAGGESE\\Documents\\GitHub\\amc_ccs\\data\\stripe_data\\2021_spring")
f21_2 <- list.files(pattern = "pdf$")
setwd("C:\\Users\\SAGGESE\\Documents\\GitHub\\amc_ccs\\data\\stripe_data\\2022_fall")
f22_2 <- list.files(pattern = "pdf$") # create a vector of PDF file names - 2022 fall only
# repeat for spring22/summer23
setwd("C:\\Users\\SAGGESE\\Documents\\GitHub\\amc_ccs\\data\\stripe_data\\2022_spring")
f22_1 <- list.files(pattern = "pdf$")
setwd("C:\\Users\\SAGGESE\\Documents\\GitHub\\amc_ccs\\data\\stripe_data\\2023_summer")
f23 <- list.files(pattern = "pdf$")
## Case example - use one PDF to see what relevant information can be extracted (and how)
bob<-pdftools::pdf_text(pdf = f23[1])
write(bob)
keyword <- "Year"
# identify first table write table 2023-2028 (beginning with Year)
bob[5]
# write table for 2029, 2030
p2 <- bob[6]
# get first table -- sequestration potential per year
txt_key <- grep(keyword, bob, value=TRUE)
lines <- unlist(strsplit(txt_key, "\n"))
df <- data.frame(Text=lines) %>%
filter(trimws(Text) != "") %>%
slice(24:n()) %>%
separate(Text, into = c("Year", "Estimated Gross Capacity (tonnes)"), sep = "              ", remove = FALSE) %>%
subset(select = -Text)
df_1 <- df[-c(1, nrow(df)), ]
install.packages("tcltk2")
PDE_install_Xpdftools4.02()    # Download and install the Xpdf command line tools
install.packages("PDE", dependencies = TRUE)
PDE_install_Xpdftools4.02()
install.packages("Xpdf")
PDE_install_Xpdftools4.02()
install.packages("PDE", dependencies = TRUE)
PDE_check_Xpdf_install()
PDE_analyzer()
library(tcltk2)
library(PDE)
PDE_install_Xpdftools4.02()
PDE_check_Xpdf_install()
install.packages(Xpdf)
PDE_install_Xpdftools4.02()
1
PDE_check_Xpdf_install()
PDE_analyzer()
PDE_analyzer_i()
# extract PDF information
PDE_analyzer_i()
# extract PDF information
PDE_analyzer_i()
# extract PDF information
PDE_analyzer_i()
PDE_reader_i()
# extract PDF information
PDE_analyzer_i()
#
# extract PDF information
PDE_analyzer_i()
# extract PDF information
PDE_analyzer_i()
library(readr)
library(readxl)
manual_aggregated_firmlist <- read_excel("C:/Users/SAGGESE/Documents/GitHub/amc_ccs/data/stripe_data/cleaned_outputs/manual-aggregated-firmlist.xlsx")
View(manual_aggregated_firmlist)
stripedf <- read_excel("C:/Users/SAGGESE/Documents/GitHub/amc_ccs/data/stripe_data/cleaned_outputs/manual-aggregated-firmlist.xlsx")
colnames
colnames(stripedf)
no_control <- lm(formula = awarded ~ price, data = stripedf)
View(no_control)
no_control
View(no_control)
summary(no_control)
class(stripedf$price)
library(readxl)
manual_aggregated_firmlist <- read_excel("C:/Users/SAGGESE/Documents/GitHub/amc_ccs/data/stripe_data/cleaned_outputs/manual-aggregated-firmlist.xlsx",
col_types = c("text", "numeric", "numeric",
"numeric", "numeric", "text", "text",
"numeric", "numeric", "numeric",
"text", "numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric"))
View(manual_aggregated_firmlist)
stripedf <- read_excel("C:/Users/SAGGESE/Documents/GitHub/amc_ccs/data/stripe_data/cleaned_outputs/manual-aggregated-firmlist.xlsx",
col_types = c("text", "numeric", "numeric",
"numeric", "numeric", "text", "text",
"numeric", "numeric", "numeric",
"text", "numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric"))
no_control <- lm(formula = awarded ~ price, data = stripedf)
summarise(no_control)
Summary
summary(no_control)
stripedf$awarded <- as.factor(stripedf$awarded)
stripedf[,'awarded'] <- as.factor(stripedf[,'awarded'])
class(stripedf$awarded)
no_control <- glm(formula = awarded ~ price, data = stripedf, family = binomial(link="logit"))
summary(no_control)
control <- glm(formula = awarded ~ (cost-price) + year, data = stripedf, family = binomial(link="logit"))
control <- glm(formula = awarded ~ (current_cost_per_tonne-price) + year, data = stripedf, family = binomial(link="logit"))
diff_realised_price <- glm(formula = awarded ~ (current_cost_per_tonne-price) + year, data = stripedf, family = binomial(link="logit"))
summary(diff_realised_price)
stripedf$realised_cost_decrease = stripedf$current_cost_per_tonne-stripedf$price
stripedf$realised_cost_decrease = (stripedf$current_cost_per_tonne-stripedf$price)
stripedf$realised_cost_decrease  <-  (stripedf$current_cost_per_tonne-stripedf$price)
stripedf$realised_cost_decrease  <- (stripedf$current_cost_per_tonne-stripedf$price)
stripedf$realised_cost_decrease <- (stripedf$current_cost_per_tonne-stripedf$price)
options(rstudio.help.showDataPreview = FALSE)
